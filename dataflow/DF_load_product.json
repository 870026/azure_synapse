{
   "name" : "DF_load_product",
   "type" : "Microsoft.DataFactory/factories/dataflows",
   "apiVersion" : "2018-06-01",
   "properties" : {
      "type" : "MappingDataFlow",
      "typeProperties" : {
         "sources" : [ {
            "dataset" : {
               "referenceName" : "PRODUCT",
               "type" : "DatasetReference"
            },
            "name" : "PRODUCT1"
         } ],
         "sinks" : [ {
            "dataset" : {
               "referenceName" : "PRODUCT",
               "type" : "DatasetReference"
            },
            "name" : "PRODUCT"
         } ],
         "transformations" : [ {
            "name" : "expProdExp"
         } ],
         "script" : "\n\nsource(output(\n\t\tSTD_COST as string,\n\t\tCOLOR as string,\n\t\tPRODUCT_NO as string,\n\t\tPRODUCT_ID as string,\n\t\tPRODUCT_NM as string,\n\t\tLIST_PRICE as string,\n\t\tSELL_ST_DT as string,\n\t\tSELL_ED_DT as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> PRODUCT1\nPRODUCT1 derive(o_SELL_ST_DT = toTimestamp(SELL_ST_DT,'DD/MM/YYYY','GMT')/*TO_DATE(SELL_ST_DT,'DD/MM/YYYY')*/,\n\t\to_SELL_ED_DT = toTimestamp(SELL_ED_DT,'DD/MM/YYYY','GMT')/*TO_DATE(SELL_ED_DT,'DD/MM/YYYY')*/) ~> expProdExp\nexpProdExp sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinsertable:true,mapColumn(\n\t\tPRODUCT_ID = PRODUCT_ID,\n\t\tPRODUCT_NM = PRODUCT_NM,\n\t\tPRODUCT_NO = PRODUCT_NO,\n\t\tCOLOR = COLOR,\n\t\tSTD_COST = STD_COST,\n\t\tLIST_PRICE = LIST_PRICE,\n\t\tSELL_ST_DT = o_SELL_ST_DT,\n\t\tSELL_ED_DT = o_SELL_ED_DT\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> PRODUCT"
      }
   },
   "dependsOn" : [ "[concat(variables('factoryId'), '/datasets/PRODUCT')]", "[concat(variables('factoryId'), '/datasets/PRODUCT')]" ]
}