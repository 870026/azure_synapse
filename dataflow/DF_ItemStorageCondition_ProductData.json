{
   "name" : "DF_ItemStorageCondition_ProductData",
   "type" : "Microsoft.DataFactory/factories/dataflows",
   "apiVersion" : "2018-06-01",
   "properties" : {
      "type" : "MappingDataFlow",
      "typeProperties" : {
         "sources" : [ {
            "dataset" : {
               "referenceName" : "MARA",
               "type" : "DatasetReference"
            },
            "name" : "MARA"
         } ],
         "sinks" : [ {
            "dataset" : {
               "referenceName" : "ItemStorageCondition",
               "type" : "DatasetReference"
            },
            "name" : "ItemStorageCondition"
         } ],
         "transformations" : [ {
            "name" : "ExpItemStorageCondition"
         } ],
         "script" : "\n\nsource(output(\n\t\tTEMPB as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> MARA\nMARA derive(StorageConditionId =  concat ( 'b_' , toString ( currentTimestamp ( ) ) ),\n\t\tItemSku =  toInteger ( concat ( 'a_' , toString ( currentTimestamp ( ) ) ) )) ~> ExpItemStorageCondition\nExpItemStorageCondition sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinsertable:true,mapColumn(\n\t\tItemSku = ItemSku,\n\t\tStorageConditionId = StorageConditionId,\n\t\tItemStorageConditionNote = TEMPB\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> ItemStorageCondition"
      }
   },
   "dependsOn" : [ "[concat(variables('factoryId'), '/datasets/MARA')]", "[concat(variables('factoryId'), '/datasets/ItemStorageCondition')]" ]
}