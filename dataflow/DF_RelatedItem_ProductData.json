{
   "name" : "DF_RelatedItem_ProductData",
   "type" : "Microsoft.DataFactory/factories/dataflows",
   "apiVersion" : "2018-06-01",
   "properties" : {
      "type" : "MappingDataFlow",
      "typeProperties" : {
         "sources" : [ {
            "dataset" : {
               "referenceName" : "MARA",
               "type" : "DatasetReference"
            },
            "name" : "MARA"
         } ],
         "sinks" : [ {
            "dataset" : {
               "referenceName" : "RelatedItem",
               "type" : "DatasetReference"
            },
            "name" : "RelatedItem"
         } ],
         "transformations" : [ {
            "name" : "Filter1"
         }, {
            "name" : "ExpRelatedItem"
         } ],
         "script" : "\n\nsource(output(\n\t\tSTOFF as string,\n\t\tMATNR as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> MARA\nExpRelatedItem filter('idwNumFactorialisNull(STOFF)') ~> Filter1\nMARA derive(ItemRelationshipTypeId = 99999,\n\t\tItemRelationshipNote = 'Hazardous Material') ~> ExpRelatedItem\nFilter1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinsertable:true,mapColumn(\n\t\tItemSku = MATNR,\n\t\tRelatedItemSku = STOFF,\n\t\tItemRelationshipTypeId = ItemRelationshipTypeId,\n\t\tItemRelationshipNote = ItemRelationshipNote\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> RelatedItem"
      }
   },
   "dependsOn" : [ "[concat(variables('factoryId'), '/datasets/MARA')]", "[concat(variables('factoryId'), '/datasets/RelatedItem')]" ]
}