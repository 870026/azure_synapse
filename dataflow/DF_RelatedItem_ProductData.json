{
   "name" : "DF_RelatedItem_ProductData",
   "type" : "Microsoft.DataFactory/factories/dataflows",
   "apiVersion" : "2018-06-01",
   "properties" : {
      "type" : "MappingDataFlow",
      "typeProperties" : {
         "sources" : [ {
            "dataset" : {
               "referenceName" : "MARA",
               "type" : "DatasetReference"
            },
            "name" : "MARA"
         } ],
         "sinks" : [ {
            "dataset" : {
               "referenceName" : "RelatedItem",
               "type" : "DatasetReference"
            },
            "name" : "RelatedItem"
         } ],
         "transformations" : [ {
            "name" : "ExpRelatedItem"
         } ],
         "script" : "\n\nsource(output(\n\t\tSTOFF as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false) ~> MARA\nMARA derive(ItemSku =  concat ( 'a_' , toString ( currentTimestamp ( ) ) ),\n\t\tItemRelationshipTypeId =  toInteger ( concat ( 'b_' , toString ( currentTimestamp ( ) ) ) ),\n\t\tItemRelationshipNote =  concat ( 'c_' , toString ( currentTimestamp ( ) ) )) ~> ExpRelatedItem\nExpRelatedItem sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinsertable:true,mapColumn(\n\t\tItemSku = ItemSku,\n\t\tRelatedItemSku = STOFF,\n\t\tItemRelationshipTypeId = ItemRelationshipTypeId,\n\t\tItemRelationshipNote = ItemRelationshipNote\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> RelatedItem"
      }
   },
   "dependsOn" : [ "[concat(variables('factoryId'), '/datasets/MARA')]", "[concat(variables('factoryId'), '/datasets/RelatedItem')]" ]
}